<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>Patient Home - ePharmaSphere</title>
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="assets/pharmacie.ico">
    <!-- Custom Google font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@100;200;300;400;500;600;700;800;900&amp;display=swap" rel="stylesheet">
    <!-- Bootstrap icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css" rel="stylesheet">
    <!-- Core theme CSS (includes Bootstrap) -->
    <link href="css/styles.css" rel="stylesheet">
    <link th:href="@{/css/styles.css}" rel="stylesheet" />
    
    <!-- Your additional stylesheets with Thymeleaf syntax -->
    <link th:href="@{/css/bootstrap.min.css}" rel="stylesheet" />
    <link th:href="@{/css/magnific-popup.css}" rel="stylesheet" />
    <link th:href="@{/css/jquery-ui.css}" rel="stylesheet" />
    <link th:href="@{/css/owl.carousel.min.css}" rel="stylesheet" />
    <link th:href="@{/css/owl.theme.default.min.css}" rel="stylesheet" />
    <link th:href="@{/css/aos.css}" rel="stylesheet" />
    <link th:href="@{/css/style.css}" rel="stylesheet" />
    <link rel="icon" type="image/x-icon" th:href="@{/assets/pharmacie.ico}" />
</head>
<body>
<main class="flex-shrink-0">
    <!-- Navigation -->
    
    <nav class="navbar navbar-expand-lg navbar-light bg-white py-3">
        <div class="container px-5">
            <a class="navbar-brand" th:href="@{/}"><span class="fw-bolder text-success">ePharmaSphere</span></a>

            <!-- Add a button-like link to the dashboardpatient.html page -->
            <a class="btn btn-success" th:href="@{/dash}">Go to Dashboard</a>
        </div>
    </nav>
    <!-- Choose Nearest Pharmacy Section -->
    <section class="py-5">
        <div class="container px-5">
            <div class="row justify-content-center">
                <div class="col-lg-6">
                    <div class="text-center my-5">
                        <h2 class="display-5 fw-bolder"><span class="text-gradient d-inline">Choose the Nearest Pharmacy</span></h2>
                    </div>
                    <form id="pharmacyForm" th:action="@{/sendMessage}" method="post" enctype="multipart/form-data">
                        <div class="mb-3">
                            <label for="pharmacySelect">Select a Pharmacy:</label>
                            <select id="pharmacySelect" name="receiverEmail" onchange="updateReceiverEmail()">
                                <option th:each="pharmacy : ${pharmacies}" th:value="${pharmacy.email}" th:text="${pharmacy.email}"></option>
                            </select>
                        </div>
                    
                        <input type="hidden" id="selectedPharmacyId" name="selectedPharmacyId" />
                        <input type="hidden" id="senderEmail" name="senderEmail" value="${userEmail}" />
                    
                        <!-- Correct the name attribute to match the one in the controller method -->
                        <input type="hidden" id="receiverEmail" name="receiverEmail" />
                    
                        <div class="mb-3">
                            <label for="message" class="form-label">Write a Message to the Pharmacy</label>
                            <textarea class="form-control" id="message" name="content" rows="4" placeholder="Enter your message"></textarea>
                        </div>
                    
                        <div class="mb-3">
                            <label for="fileUpload" class="form-label">Upload a File</label>
                            <input type="file" class="form-control" id="fileUpload" name="file">
                        </div>
                    
                        <!-- Use a button to submit the form instead of an anchor tag -->
                        <button type="submit" class="btn btn-success" onclick="addMessage()">Send Message and/or File</button>
                    </form>
                </div>
            </div>
        </div>
    </section>
</main>
<!-- Footer -->
<footer class="bg-white py-4 mt-auto">
    <div class="container px-5">
        <div class="row align-items-center justify-content-between flex-column flex-sm-row">
            <div class="col-auto">
                <div class="small m-0">Copyright &copy; ePharmaSphere 2023</div>
            </div>
            <div class="col-auto">
                <a class="small" href="#">Privacy</a>
                <span class="mx-1">&middot;</span>
                <a class="small" href="#">Terms</a>
                <span class="mx-1">&middot;</span>
                <a class="small" href="#">Contact</a>
            </div>
        </div>
    </div>
</footer>
<!-- Bootstrap core JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
<!-- Core theme JS -->
<!-- Add this script block at the end of your HTML file, before the closing </body> tag -->
<script src="/assets/js/homepagepatient.js">
    function updateReceiverEmail() {
        var selectedPharmacy = document.getElementById("pharmacySelect");
        var receiverEmailInput = document.getElementById("receiverEmail");

        receiverEmailInput.value = selectedPharmacy.value;
    }

    function addMessage() {
        // Additional logic to handle form submission or AJAX call
        // You can use JavaScript to submit the form or perform other actions
        document.getElementById("pharmacyForm").submit();
    }
</script>

</body>
</html>